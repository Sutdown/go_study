# 项目实战



#### 用到的库

##### viper

[Viper](https://github.com/spf13/viper)是 Go 语言中一款功能强大的配置管理库，旨在简化应用程序的配置处理。它支持多种配置文件格式，包括 JSON、TOML、YAML、HCL、envfile 和 Java properties 等。此外，Viper 还提供了从环境变量、命令行标志、远程配置系统（如 etcd 或 Consul）以及直接在代码中设置配置值的功能。

##### sqlx

`sqlx` 是 Go 语言中的一个库，扩展了标准的 `database/sql` 库，简化了数据库操作，提供了更多的功能和便捷的方法，尤其是在处理结构体与数据库表之间的映射时。它的目标是提供比原生 `database/sql` 更简洁、更高效的数据库操作方式，同时仍保持与标准库的兼容性。

##### lumberjack

`lumberjack` 是 Go 语言中的一个库，主要用于 **日志轮转**（log rotation）和 **日志文件管理**。它提供了自动的日志文件切割功能，可以避免日志文件过大，从而有效管理日志的存储空间

##### zap

- 能够将事件**记录**到文件中，而不是应用程序控制台。
- 日志**切割**-能够根据文件大小、时间或间隔等来切割日志文件。
- 支持不同的日志**级别**。例如INFO，DEBUG，ERROR等。
- 能够**打印**基本信息，如调用文件/函数名和行号，日志时间等

##### validator

`validator` 是一个用于 Go 语言的强大且灵活的数据验证库，通常用于验证结构体中的字段是否符合某些规则。它通过标签（tags）来指定验证规则，支持各种常见的数据验证功能，例如字符串长度、邮箱格式、正则表达式匹配、数值范围等。



### 设计理念



#### 基于雪花算法生成用户id

##### 分布式ID生成器

- 全局唯一性：不能出现有重复的ID标识，这是基本要求
- 递增性：确保生成ID对于用户或业务是递增的
- 高可用性：任何情况都能生成正确的ID
- 高性能性，高并发环境下表现良好

[雪花算法 - 维基百科，自由的百科全书](https://zh.wikipedia.org/wiki/雪花算法)

###### bwmarrn/snowflake

```txt
1bit Unused | 41bit 时间戳 | 10bit 机器ID | 12bit 序列号
```

snoy/snoyflake

1 + 39 +8（序列号） + 16(机器id)
